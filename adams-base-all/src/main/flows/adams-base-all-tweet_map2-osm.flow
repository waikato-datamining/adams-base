# Project: adams
# Date: 2015-04-21 10:41:27
# User: fracpete
#
adams.flow.control.Flow
	-annotation
	Example flow for listens to status updates and displays \nthe ones with geo location data on a world map.
	-actor
		adams.flow.standalone.CallableActors
			-actor
				adams.flow.control.Sequence
					-name
					TweetMap
					-actor
						adams.flow.transformer.Convert
							-name
							map objects
							-conversion
								adams.data.conversion.SpreadSheetToMapObjects
									-generator
										adams.data.conversion.mapobject.SimpleDotMarkerGenerator
											-layer
											@{layer}
											-gps
											1
											-additional-attributes
											2-last
											-dot-color
											@{color}
					-actor
						adams.flow.sink.OpenStreetMapViewer
							-name
							TweetMap
							-writer
								adams.gui.print.NullWriter
							-tile-source
								adams.flow.sink.openstreetmapviewer.OpenStreetMapSource
							-tile-loader
								adams.flow.sink.openstreetmapviewer.OpenStreetMapCachedLoader
							-hit-listener
								adams.flow.sink.openstreetmapviewer.SimpleMapObjectHitListener
							-click-listener
								adams.flow.sink.openstreetmapviewer.NullMapClickListener
							-mapobject-pruner
								adams.flow.sink.openstreetmapviewer.MaxAgePruner
									-max-age
									START -30 MINUTE
							-map-overlay
								adams.flow.sink.openstreetmapviewer.NullMapOverlay
							-initial-zoom
							1
							-layer-tree
							true
							-layer
							Tweets
							-layer
							Tweets.happy
							-layer
							Tweets.sad
	-actor
		adams.flow.standalone.TwitterConnection
	-actor
		adams.flow.source.TwitterListener
			-max-updates
			1000000
	-actor
		adams.flow.transformer.TwitterFilter
			-expression
			has(latitude) and has(longitude)
	-actor
		adams.flow.transformer.TwitterConverter
			-converter
				adams.data.twitter.SpreadSheetConverter
					-field
					GEO_LATITUDE
					-field
					GEO_LONGITUDE
					-field
					TEXT
					-data-row-type
						adams.data.spreadsheet.DenseDataRow
					-spreadsheet-type
						adams.data.spreadsheet.SpreadSheet
	-actor
		adams.flow.transformer.Convert
			-name
			join long/lat
			-conversion
				adams.data.conversion.SpreadSheetJoinColumns
					-columns
					1,2
					-glue
					 
	-actor
		adams.flow.transformer.Convert
			-name
			gps
			-conversion
				adams.data.conversion.SpreadSheetStringColumnToObject
					-no-copy
					true
					-handler
						adams.data.spreadsheet.GPSDecimalDegrees
	-actor
		adams.flow.control.Tee
			-name
			:-)
			-annotation
			tweet text contains \":)\" or \":-)\"
			-tee
				adams.flow.transformer.SpreadSheetRowFilter
					-finder
						adams.data.spreadsheet.rowfinder.ByValue
							-att-index
							TEXT
							-reg-exp
							.*(:\\)|:-\\)|ðŸ˜…|ðŸ˜Š).*
			-tee
				adams.flow.transformer.SetVariable
					-name
					layer name
					-var-name
					layer
					-var-value
					Tweets.happy
			-tee
				adams.flow.transformer.SetVariable
					-name
					color
					-var-name
					color
					-var-value
					#00ff00
			-tee
				adams.flow.sink.CallableSink
					-callable
					TweetMap
	-actor
		adams.flow.control.Tee
			-name
			:-(
			-annotation
			tweet text contains \":(\" or \":-(\"
			-tee
				adams.flow.transformer.SpreadSheetRowFilter
					-finder
						adams.data.spreadsheet.rowfinder.ByValue
							-att-index
							TEXT
							-reg-exp
							.*(:\\(|:-\\(|ðŸ˜ž|ðŸ˜¥).*
			-tee
				adams.flow.transformer.SetVariable
					-name
					layer name
					-var-name
					layer
					-var-value
					Tweets.sad
			-tee
				adams.flow.transformer.SetVariable
					-name
					color
					-var-name
					color
					-var-value
					#0000ff
			-tee
				adams.flow.sink.CallableSink
					-callable
					TweetMap
	-flow-execution-listener
		adams.flow.execution.NullListener

